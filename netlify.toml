[build]
  command = "OUTPUT=netlify astro build"
  publish = "dist"
  environment = { NETLIFY_USE_PNPM = "true" }

# 设置重定向规则
[[redirects]]
  from = "/api/auth"
  to = "/.netlify/edge-functions/entry"
  status = 200

[[redirects]]
  from = "/api/generate"
  to = "/.netlify/edge-functions/entry"
  status = 200

[[redirects]]
  from = "/password"
  to = "/.netlify/edge-functions/entry"
  status = 200

[[redirects]]
  from = "/"
  to = "/.netlify/edge-functions/entry"
  status = 200

[[headers]]
  for = "/manifest.webmanifest"
  [headers.values]
    Content-Type = "application/manifest+json"

# 合并两个 functions 块为一个
[functions]
  node_bundler = "esbuild"
  directory = ".netlify/edge-functions"
